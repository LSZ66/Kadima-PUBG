<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>添加用户</title>
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
    <script src="../assets/js/jquery.js"></script>
    <script src="../assets/js/bootstrap.min.js"></script>
    <script src="../assets/layer/layer.js"></script>
</head>
<body>
<div class="container">
    <h3 class="text-center">添加用户</h3><br/>
    <form action="/user" method="post" id="userForm">
        <input hidden name="action" value="add"/>
        <div class="input-group input-group-md">
            <span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
            <input type="text" class="form-control" name="username" placeholder="请输入用户名" required/>
        </div>
        <br/>
        <div class="input-group input-group-md">
            <span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
            <input type="password" class="form-control" name="password" placeholder="请输入密码" required/>
        </div>
        <br/>
        <div class="input-group input-group-md">
            <span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
            <input type="password" class="form-control" name="confirmPassword" placeholder="请确认密码" required/>
        </div>
        <br/>
    </form>
    <div style="text-align: center">
        <button onclick="register()" class="btn btn-success">提交</button>
    </div>
</div>
</body>
<script>
    $(function () {
        $(document).keydown(function (event) {
            if (event.keyCode === 13)
                register();
        })
    });

    function register() {
        $.post("/user", $("#userForm").serialize(), function (data) {
            if (data == 0)
                layer.msg("两次密码输入不匹配，请确认后再试");
            else if (data == 2)
                layer.msg("用户已存在，请更换用户名后再试");
            else if (data == 3)
                layer.msg("请完成表单后再提交");
            else {
                opener.location.href = opener.location.href;
                close();
                layer.msg('添加用户成功')
            }
        }, "text")
    }
</script>
</html>